<!doctype html>

<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>Goonhub Auth</title>
  <style>
    * {
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
    }

    body {
      margin: 0;
      padding: 0;
      background: #303030;
    }

    iframe {
      display: block;
      width: 100%;
      height: 100%;
      border: 0;
    }
  </style>
</head>

<body>
  <iframe src="{goonhub_url}/game-auth/{route}"></iframe>
  <script>
    (function () {
      var ref = '{ref}';

      window.addEventListener('message', function (event) {
        if (event.origin !== '{goonhub_url}') {
          return;
        }

        if (event.data.type === 'authenticated') {
          window.location =
            'byond://?src=' +
            ref +
            ';authenticated=1;user=' +
            encodeURIComponent(JSON.stringify(event.data.user));
        } else if (event.data.type === 'logout') {
          window.location = 'byond://?src=' + ref + ';logout=1';
        }
      });
    })();
  </script>
</body>
